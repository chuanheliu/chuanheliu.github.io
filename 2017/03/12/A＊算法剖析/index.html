<!DOCTYPE html>
<html lang="zh-hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Chuanhe Liu" />



<meta name="description" content="在网上已经有很多篇关于A星寻路算法的文章，但是大部分都是提供给已经了解基本原理的高级开发者的。
本篇教程将从最基本的原理讲起。我们会一步步讲解A星寻路算法，幷配有很多图解和例子。
不管你使用的是什么编程语言或者操作平台，你会发现本篇教程很有帮助，因为它在非编程语言的层面上解释了算法的原理。">
<meta property="og:type" content="article">
<meta property="og:title" content="A＊算法剖析">
<meta property="og:url" content="http://yoursite.com/2017/03/12/A＊算法剖析/index.html">
<meta property="og:site_name" content="chuanhe的博客">
<meta property="og:description" content="在网上已经有很多篇关于A星寻路算法的文章，但是大部分都是提供给已经了解基本原理的高级开发者的。
本篇教程将从最基本的原理讲起。我们会一步步讲解A星寻路算法，幷配有很多图解和例子。
不管你使用的是什么编程语言或者操作平台，你会发现本篇教程很有帮助，因为它在非编程语言的层面上解释了算法的原理。">
<meta property="og:image" content="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Init.jpg">
<meta property="og:image" content="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_SearchArea.jpg">
<meta property="og:image" content="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_A.jpg">
<meta property="og:image" content="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_G.jpg">
<meta property="og:image" content="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_H.jpg">
<meta property="og:image" content="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_1.jpg">
<meta property="og:image" content="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_2.jpg">
<meta property="og:image" content="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_3.jpg">
<meta property="og:image" content="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_4.jpg">
<meta property="og:image" content="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_5.jpg">
<meta property="og:image" content="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_6.jpg">
<meta property="og:image" content="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Paths.jpg">
<meta property="og:image" content="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_7.jpg">
<meta property="og:image" content="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_8.jpg">
<meta property="og:image" content="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_9.jpg">
<meta property="og:image" content="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_NotExtralucid1.jpg">
<meta property="og:image" content="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_NotExtralucid2.jpg">
<meta property="og:updated_time" content="2017-03-12T00:22:18.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A＊算法剖析">
<meta name="twitter:description" content="在网上已经有很多篇关于A星寻路算法的文章，但是大部分都是提供给已经了解基本原理的高级开发者的。
本篇教程将从最基本的原理讲起。我们会一步步讲解A星寻路算法，幷配有很多图解和例子。
不管你使用的是什么编程语言或者操作平台，你会发现本篇教程很有帮助，因为它在非编程语言的层面上解释了算法的原理。">
<meta name="twitter:image" content="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Init.jpg">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="chuanhe的博客" type="application/atom+xml">



    <link rel="shortcut icon" href="https://raw.githubusercontent.com/chuanheliu/chuanheliu.github.io/master/img/JavaLogo.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>A＊算法剖析 | chuanhe的博客</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="https://avatars1.githubusercontent.com/u/23323529?v=3&amp;u=a6376b504d3914b39497c03224b899c1c2f6ede7&amp;s=400" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Chuanhe Liu</a></h1>
        </hgroup>

        
        <p class="header-subtitle">Java影响睡眠</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" href="https://github.com/chuanheliu" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa 网易云音乐" href="http://music.163.com/#/user/home?id=110295168" title="网易云音乐"></a>
                            
                                <a class="fa Email" href="mailto:chuanheliu@163.com" title="Email"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://blog.yfgeek.com/">Ivan&#39;s Blog</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">英格兰友人的最爱</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Chuanhe Liu</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="https://avatars1.githubusercontent.com/u/23323529?v=3&amp;u=a6376b504d3914b39497c03224b899c1c2f6ede7&amp;s=400" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Chuanhe Liu</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Java影响睡眠</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/chuanheliu" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa 网易云音乐" target="_blank" href="http://music.163.com/#/user/home?id=110295168" title="网易云音乐"></a>
                            
                                <a class="fa Email" target="_blank" href="mailto:chuanheliu@163.com" title="Email"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-A＊算法剖析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/12/A＊算法剖析/" class="article-date">
      <time datetime="2017-03-12T21:48:04.000Z" itemprop="datePublished">2017-03-12</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      A＊算法剖析
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p></p><p>在网上已经有很多篇关于A星寻路算法的文章，但是大部分都是提供给已经了解基本原理的高级开发者的。</p><p></p>
<p></p><p>本篇教程将从最基本的原理讲起。我们会一步步讲解A星寻路算法，幷配有很多图解和例子。</p><p></p>
<p></p><p>不管你使用的是什么编程语言或者操作平台，你会发现本篇教程很有帮助，因为它在非编程语言的层面上解释了算法的原理。</p><a id="more"></a><p></p>
<p></p><p>现在找下到达一杯咖啡因饮料和美味的零食的最短路径，开始吧！:]</p><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><h2><strong>一只探路猫</strong></h2><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>让我们想象一下，有一款游戏，游戏中一只猫想要找到获取骨头的路线。</p><p></p>
<p></p><p>&ldquo;为什么会有一只猫想要骨头？！&rdquo;你可能会这么想。在本游戏中， 这是一只狡猾的猫，他想捡起骨头给狗，以防止被咬死！:]</p><p></p>
<p></p><p>现在想像一下下图中的猫想找到到达骨头的最短路径：</p><p></p>
<p></p><p><a href="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Init.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4948" title="This cat just wants someone to throw him a bone!" src="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Init.jpg" alt="This cat just wants someone to throw him a bone!" width="480" height="432"></a></p><p></p>
<p></p><p>不幸的是，猫不能直接从它当前的位置走到骨头的位置，因为有面墙挡住了去路，而且它在游戏中不是一只幽灵猫！</p><p></p>
<p></p><p>游戏中的猫同样懒惰，它总是想找到最短路径，这样当他回家看望它的女朋友时不会太累:-)</p><p></p>
<p></p><p>但是我们如何编写一个算法计算出猫要选择的那条路径呢？A星算法拯救了我们！</p><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><h2><strong>简化搜索区域</strong></h2><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>寻路的第一步是简化成容易控制的搜索区域。</p><p></p>
<p></p><p>怎么处理要根据游戏来决定了。例如，我们可以将搜索区域划分成像素点，但是这样的划分粒度对于我们这款基于方块的游戏来说太高了（没必要）。</p><p></p>
<p></p><p>作为代替，我们使用方块（一个正方形）作为寻路算法的单元。其他的形状类型也是可能的（比如三角形或者六边形），但是正方形是最简单并且最适合我们需求的。</p><p></p>
<p></p><p>像那样去划分，我们的搜索区域可以简单的用一个地图大小的二维数组去表示。所以如果是25<em>25方块大小的地图，我们的搜索区域将会是一个有625 个正方形的数组。如果我们把地图划分成像素点，搜索区域就是一个有640，000个正方形的数组了（一个方块是32</em>32像素）！</p><p></p>
<p></p><p>现在让我们基于目前的区域，把区域划分成多个方块来代表搜索空间（在这个简单的例子中，7*6个方块 = 42 个方块）：</p><p></p>
<p></p><p><a href="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_SearchArea.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4949" title="Dividing the maze into a tile-based search area" src="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_SearchArea.jpg" alt="Dividing the maze into a tile-based search area" width="480" height="432"></a></p><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><h2><strong>Open和Closed列表</strong></h2><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>既然我们创建了一个简单的搜索区域，我们来讨论下A星算法的工作原理吧。</p><p></p>
<p></p><p>除了懒惰之外，我们的猫没有好的记忆力，所以它需要两个列表：</p><p></p>
<p><ol></ol></p>
<li>一个记录下所有被考虑来寻找最短路径的方块（称为open 列表）</li><br><li>一个记录下不会再被考虑的方块（成为closed列表）</li><br><br><p>猫首先在closed列表中添加当前位置（我们把这个开始点称为点 &ldquo;A&rdquo;）。然后，把所有与它当前位置相邻的可通行小方块添加到open列表中。</p><br><p>下图是猫在某一位置时的情景（绿色代表open列表）:<br><br><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_A.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4950" title="Adding adjacent tiles from the start position to the open list" src="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_A.jpg" alt="Adding adjacent tiles from the start position to the open list" width="480" height="432"></a></p><br><p>现在猫需要判断在这些选项中，哪项才是最短路径，但是它要如何去选择呢？</p><br><p>在A星寻路算法中，通过给每一个方块一个和值，该值被称为路径增量。让我们看下它的工作原理！</p><br><h2>路径增量</h2><br><p>&nbsp;</p><br><p>我们将会给每个方块一个G+H 和值：</p><br><ul><br><li>G是从开始点A到当前方块的移动量。所以从开始点A到相邻小方块的移动量为1，该值会随着离开始点越来越远而增大。</li><br><li>H是从当前方块到目标点（我们把它称为点B，代表骨头！）的移动量估算值。这个常被称为探视，因为我们不确定移动量是多少 &ndash; 仅仅是一个估算值。</li>

<p></p></ul><p></p>
<p></p><p>你也许会对&ldquo;移动量&rdquo;感兴趣。在游戏中，这个概念很简单 &ndash; 仅仅是方块的数量。</p><p></p>
<p></p><p>然而，在游戏中你可以对这个值做调整。例如：</p><p></p>
<p><ul></ul></p>
<li>如果你允许对角线移动，你可以针对对角线移动把移动量调得大一点。</li><br><li>如果你有不同的地形，你可以将相应的移动量调整得大一点 &ndash; 例如针对一块沼泽，水，或者猫女海报:-)</li>

<p></p>
<p></p><p>这就是大概的意思 &ndash; 现在让我们详细分析下如何计算出G和H值。</p><p></p>
<p></p><h2>关于G值</h2><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>G是从开始点A到达当前方块的移动量（在本游戏中是指方块的数目）。</p><p></p>
<p></p><p>为了计算出G的值，我们需要从它的前继（上一个方块）获取，然后加1。所以，每个方块的G值代表了从点A到该方块所形成路径的总移动量。</p><p></p>
<p></p><p>例如，下图展示了两条到达不同骨头的路径，每个方块都标有它的G值：<br><br><a href="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_G.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4951" title="An illustration of the G variable in the A* Pathfinding Algorithm" src="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_G.jpg" alt="An illustration of the G variable in the A* Pathfinding Algorithm" width="480" height="432"></a></p><p></p>
<p></p><h2>关于H值</h2><p></p>
<p></p><p>H值是从当前方块到终点的移动量估算值（在本游戏中是指方块的数目）。</p><p></p>
<p></p><p>移动量估算值离真实值越接近，最终的路径会更加精确。如果估算值停止作用，很可能生成出来的路径不会是最短的（但是它可能是接近的）。这个题目相对复杂，所以我们不会再本教程中讲解，但是我在教程的末尾提供了一个网络链接，对它做了很好的解释。</p><p></p>
<p></p><p>为了让它更简单，我们将使用&ldquo;曼哈顿距离方法&rdquo;（也叫&ldquo;曼哈顿长&rdquo;或者&ldquo;城市街区距离&rdquo;），它只是计算出距离点B，剩下的水平和垂直的方块数量，略去了障碍物或者不同陆地类型的数量。</p><p></p>
<p></p><p>例如，下图展示了使用&ldquo;城市街区距离&rdquo;，从不同的开始点到终点，去估算H的值（黑色字）：<br><br><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_H.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4952" title="An illustration of the H variable in the A* pathfinding algorithm with the Manhattan algorithm" src="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_H.jpg" alt="An illustration of the H variable in the A* pathfinding algorithm with the Manhattan algorithm" width="480" height="432"></a></p><p></p>
<p></p><h2>A星算法</h2><p></p>
<p></p><p>&nbsp;</p><p></p>
<p></p><p>既然你知道如何计算每个方块的和值（我们将它称为F，等于G+H), &nbsp;我们来看下A星算法的原理。</p><p></p>
<p></p><p>猫会重复以下步骤来找到最短路径：</p><p></p>
<p><ol></ol></p>
<li>将方块添加到open列表中，该列表有最小的和值。且将这个方块称为S吧。</li><br><li>将S从open列表移除，然后添加S到closed列表中。</li><br><li>对于与S相邻的每一块可通行的方块T：</li>

<p></p>
<p><ul><ol></ol></ul></p>
<li>如果T在closed列表中：不管它。</li><br><li>如果T不在open列表中：添加它然后计算出它的和值。</li><br><li>如果T已经在open列表中：当我们使用当前生成的路径到达那里时，检查F 和值是否更小。如果是，更新它的和值和它的前继。</li>

<p></p>
<p></p><p>如果你对它的工作原理还有点疑惑，不用担心 &ndash; 我们会用例子一步步介绍它的原理！:]</p><p></p>
<p></p><h2><strong>猫的路径</strong></h2><p></p>
<p></p><p>让我们看下我们的懒猫到达骨头的行程例子。</p><p></p>
<p></p><p>在下图中，我根据以下内容，列出了公式F = G + H 中的每项值：</p><p></p>
<p><ul></ul></p>
<li>F（方块的和值）：左上角</li><br><li>G（从A点到方块的移动量）：左下角</li><br><li>H（从方块到B点的估算移动量): 右下角</li>

<p></p>
<p></p><p>同时，箭头指示了到达相应方块的移动方向。</p><p></p>
<p></p><p>最后，在每一步中，红色方块表示closed列表，绿色方块表示open列表。</p><p></p>
<p></p><p>好的，我们开始吧！</p><p></p>
<p></p><p>第一步</p><p></p>
<p></p><p>第一步，猫会确定相对于开始位置（点A）的相邻方块，计算出他们的F和值，然后把他们添加到open列表中：<br><br><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_1.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4953" title="A* Example Part 1" src="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_1.jpg" alt="A* Example Part 1" width="480" height="432"></a></p><p></p>
<p></p><p>你会看到每个方块都列出了H值（有两个是6，一个是4）。我建议根据&ldquo;城市街区距离&rdquo;去计算方块的相关值，确保你理解了它的原理。</p><p></p>
<p></p><p>同时注意F值（在左上角）是G（左下角）值和H（右下脚）值的和。<br><br>第二步</p><p></p>
<p></p><p>在第二步中，猫选择了F和值最小的方块，把它添加到closed列表中，然后检索它的相邻方块的相关数值。<br><br><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_2.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4954" title="A* Example Part 2" src="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_2.jpg" alt="A* Example Part 2" width="480" height="432"></a></p><p></p>
<p></p><p>现在你将看到拥有最小增量的是F值为4的方块。猫尝试添加所有相邻的方块到open列表中（然后计算他们的和值），除了猫自身的方块不能添加以外（因为它已经被添加到了closed列表中）或者它是墙壁方块（因为它不能通行）。</p><p></p>
<p></p><p>注意被添加到open列表的两个新方块，他们的G值都增加了1，因为他们现在离开始点有2个方块远了。你也许需要再计算下&ldquo;城市街区距离&rdquo;以确保你理解了每个新方块的H值。<br><br><em>第三步</em></p><p></p>
<p></p><p>再次，我们选择了有最小F和值（5）的方块，继续重复之前的步骤：<br><br><a href="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_3.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4955" title="A* Example Part 3" src="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_3.jpg" alt="A* Example Part 3" width="480" height="432"></a></p><p></p>
<p></p><p>现在，只有一个可能的方块被添加到open列表中了，因为已经有一个相邻的方块在close列表中，其他两个是墙壁方块。</p><p></p>
<p></p><p><em>第四步</em></p><p></p>
<p></p><p>现在我们遇到了一个有趣的情况。正如你之前看到的，有4个方块的F和值都为7 &ndash; 我们要怎么做呢？！</p><p></p>
<p></p><p>有几种解决方法可以使用，但是最简单（快速）的方法是一直跟着最近被添加到open列表中的方块。现在继续沿着最近被添加的方块前进。<br><br><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_4.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4956" title="A* Example Part 4" src="http://cdn5.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_4.jpg" alt="A* Example Part 4" width="480" height="432"></a></p><p></p>
<p></p><p>这次有两个可通过的相邻方块了，我们还是像之前那样计算他们的和值。<br><br><em>第五步</em></p><p></p>
<p></p><p>接着我们选择了最小和值（7）的方块，继续重复之前的步骤：<br><br><a href="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_5.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4957" title="A* Example Part 5" src="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_5.jpg" alt="A* Example Part 5" width="480" height="432"></a></p><p></p>
<p></p><p>我们越来越接近终点了！<br><br></p><p></p>
<p></p><p><em>第六步</em></p><p></p>
<p></p><p>你现在训练有素了！我打赌你能够猜出下一步是下面这样子了：<br><br><a href="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_6.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4958" title="A* Example Part 6" src="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_6.jpg" alt="A* Example Part 6" width="480" height="432"></a></p><p></p>
<p></p><p>我们差不多到终点了，但是这次你看到有两条到达骨头的最短路径提供给我们选择：<br><br><a href="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Paths.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4959" title="Two shortest paths to the bone" src="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_Paths.jpg" alt="Two shortest paths to the bone" width="479" height="432"></a></p><p></p>
<p></p><p>在我们的例子中，有两条最短路径：</p><p></p>
<p><ul></ul></p>
<li>1-2-3-4-5-6</li><br><li>1-2-3-4-5-7</li>

<p></p>
<p></p><p>It doesn&rsquo;t really matter which of these we choose, it comes down to the actual implementation in code.</p><p></p>
<p></p><p>选择哪一条其实没关系，现在到了真正用代码实现的时候了。<br><br></p><p></p>
<p></p><p><em>第七步</em></p><p></p>
<p></p><p>让我们从其中一块方块，再重复一遍步骤吧：<br><br><a href="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_7.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4960" title="A* Example Part 7" src="http://cdn2.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_7.jpg" alt="A* Example Part 7" width="480" height="432"></a></p><p></p>
<p></p><p>啊哈，骨头在open列表中了！<br><br><em>第八步</em></p><p></p>
<p></p><p>现在目标方块在open列表中了，算法会把它添加到closed列表中：<br><br><a href="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_8.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4961" title="A* Example Part 8" src="http://cdn4.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_8.jpg" alt="A* Example Part 8" width="480" height="432"></a></p><p></p>
<p></p><p>然后，算法要做的所有事情就是返回，计算出最终的路径！<br><br><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_9.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4962" title="A* Example Part 9" src="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_9.jpg" alt="A* Example Part 9" width="480" height="432"></a></p><p></p>
<p></p><h2>一只有远见的猫</h2><p></p>
<p></p><p>在上面的例子中，我们看到当猫在寻找最短路径时，它经常选择更好的方块（那个在它的未来最短路径上的方块）- 好像它是一只有远见的猫！</p><p></p>
<p></p><p>但是如果猫是盲目的，并且总是选择第一个添加到它的列表上的方块，会发生什么事情？</p><p></p>
<p></p><p>下图展示了所有在寻找过程中会被使用到的方块。你会看到猫在尝试更多的方块，但是它仍然找到了最短路径（不是之前的那条，而是另一条等价的）：<br><br><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_NotExtralucid1.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4963" title="What would happen if the cat wasn't so smart..." src="http://cdn3.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_NotExtralucid1.jpg" alt="What would happen if the cat wasn't so smart..." width="479" height="432"></a></p><p></p>
<p></p><p>图中的红色方块不代表最短路径，它们只是代表在某个时候被选择为&ldquo;S&rdquo;的方块。</p><p></p>
<p></p><p>我建议你看着上面的图，并且尝试过一遍步骤。这次无论你看到哪个相邻的方块，都选择&ldquo;最坏&rdquo;的方式去走。你会发现最后还是找到了最短路径！</p><p></p>
<p></p><p>所以你可以看到跟随一个&ldquo;错误的&rdquo;方块是没有问题的，你仍然会在多次重复尝试后找到最短路径。</p><p></p>
<p></p><p>所以在我们的实现中，我们会按照以下的算法添加方块到open列表中：</p><p></p>
<p><ul></ul></p>
<li>相邻的方块会返回这些顺序: 上面/左边/下面/右边。</li><br><li>当所有的方块都有相同的和值后，方块会被添加到open列表中（所以第一个被添加的方块是第一个被猫挑选的）。</li>

<p></p>
<p></p><p>下面是从原路返回的示意图：<br><br><a href="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_NotExtralucid2.jpg" target="_blank" rel="external"><img class="alignnone size-full wp-image-4964" title="The cat finding the shortest path, even after some wrong turns" src="http://cdn1.raywenderlich.com/wp-content/uploads/2011/09/Cat-Maze_NotExtralucid2.jpg" alt="The cat finding the shortest path, even after some wrong turns" width="480" height="432"></a></p><p></p>
<p></p><p>最短的路径是从终点开始，一步步返回到起点构成的（例子：在终点我们可以看到箭头指向右边，所以该方块的前继在它的左边）。</p><p></p>
<p></p><p>总的来说，我们可以用下面的伪代码，合成猫的寻找过程。这是Objective-C写的，但是你可以用任何的语言去实现它：</p><p></p>
<p><div class="wp_codebox"></div></p>
<p><table></table></p>
<p><tbody></tbody></p>
<p><tr id="p215031"></tr></p>
<p><td id="p21503code1" class="code"></td></p>
<p><pre class="objc"><span style="color: #002200;">[</span>openList add<span style="color: #002200;">:</span>originalSquare<span style="color: #002200;">]</span>; <span style="color: #11740a; font-style: italic;">// start by adding the original position to the open list</span><br><span style="color: #a61390;">do</span> <span style="color: #002200;">{</span><br>    currentSquare <span style="color: #002200;">=</span> <span style="color: #002200;">[</span>openList squareWithLowestFScore<span style="color: #002200;">]</span>; <span style="color: #11740a; font-style: italic;">// Get the square with the lowest F score</span><br>&nbsp;<br>    <span style="color: #002200;">[</span>closedList add<span style="color: #002200;">:</span>currentSquare<span style="color: #002200;">]</span>; <span style="color: #11740a; font-style: italic;">// add the current square to the closed list</span><br>    <span style="color: #002200;">[</span>openList <a href="http://www.opengroup.org/onlinepubs/009695399/functions/remove.html" target="_blank" rel="external"><span style="color: #a61390;">remove</span></a><span style="color: #002200;">:</span>currentSquare<span style="color: #002200;">]</span>; <span style="color: #11740a; font-style: italic;">// remove it to the open list</span><br>&nbsp;<br>    <span style="color: #a61390;">if</span> <span style="color: #002200;">(</span><span style="color: #002200;">[</span>closedList contains<span style="color: #002200;">:</span>destinationSquare<span style="color: #002200;">]</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span> <span style="color: #11740a; font-style: italic;">// if we added the destination to the closed list, we’ve found a path</span><br>        <span style="color: #11740a; font-style: italic;">// PATH FOUND</span><br>        <span style="color: #a61390;">break</span>; <span style="color: #11740a; font-style: italic;">// break the loop</span><br>    <span style="color: #002200;">}</span><br>&nbsp;<br>    adjacentSquares <span style="color: #002200;">=</span> <span style="color: #002200;">[</span>currentSquare walkableAdjacentSquares<span style="color: #002200;">]</span>; <span style="color: #11740a; font-style: italic;">// Retrieve all its walkable adjacent squares</span><br>&nbsp;<br>    <span style="color: #a61390;">foreach</span> <span style="color: #002200;">(</span>aSquare <span style="color: #a61390;">in</span> adjacentSquares<span style="color: #002200;">)</span> <span style="color: #002200;">{</span><br>&nbsp;<br>        <span style="color: #a61390;">if</span> <span style="color: #002200;">(</span><span style="color: #002200;">[</span>closedList contains<span style="color: #002200;">:</span>aSquare<span style="color: #002200;">]</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span> <span style="color: #11740a; font-style: italic;">// if this adjacent square is already in the closed list ignore it</span><br>            <span style="color: #a61390;">continue</span>; <span style="color: #11740a; font-style: italic;">// Go to the next adjacent square</span><br>        <span style="color: #002200;">}</span><br>&nbsp;<br>        <span style="color: #a61390;">if</span> <span style="color: #002200;">(</span><span style="color: #002200;">!</span><span style="color: #002200;">[</span>openList contains<span style="color: #002200;">:</span>aSquare<span style="color: #002200;">]</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span> <span style="color: #11740a; font-style: italic;">// if its not in the open list</span><br>&nbsp;<br>            <span style="color: #11740a; font-style: italic;">// compute its score, set the parent</span><br>            <span style="color: #002200;">[</span>openList add<span style="color: #002200;">:</span>aSquare<span style="color: #002200;">]</span>; <span style="color: #11740a; font-style: italic;">// and add it to the open list</span><br>&nbsp;<br>        <span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">{</span> <span style="color: #11740a; font-style: italic;">// if its already in the open list</span><br>&nbsp;<br>            <span style="color: #11740a; font-style: italic;">// test if using the current G score make the aSquare F score lower, if yes update the parent because it means its a better path</span><br>&nbsp;<br>        <span style="color: #002200;">}</span><br>    <span style="color: #002200;">}</span><br>&nbsp;<br><span style="color: #002200;">}</span> <span style="color: #a61390;">while</span><span style="color: #002200;">(</span><span style="color: #002200;">!</span><span style="color: #002200;">[</span>openList isEmpty<span style="color: #002200;">]</span><span style="color: #002200;">)</span>; <span style="color: #11740a; font-style: italic;">// Continue until there is no more available square in the open list (which means there is no path)</span></pre></p>

      
    </div>
    
  </div>
  
    


    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/05/08/111/">
                    test
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/03/08/编程能力与编程年龄/">
                    编程能力与编程年龄
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">一只探路猫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">简化搜索区域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">Open和Closed列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">路径增量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">关于G值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">6.</span> <span class="toc-text">关于H值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">7.</span> <span class="toc-text">A星算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">8.</span> <span class="toc-text">猫的路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">9.</span> <span class="toc-text">一只有远见的猫</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"A＊算法剖析　| chuanhe的博客　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/05/08/111/" title="上一篇: test">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/03/08/编程能力与编程年龄/" title="下一篇: 编程能力与编程年龄">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/08/111/">test</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/12/A＊算法剖析/">A＊算法剖析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/08/编程能力与编程年龄/">编程能力与编程年龄</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/13/Java IO流体系中常用的流分类/">Java IO流体系中常用的流分类</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/22/机器学习主流算法分析/">机器学习主流算法分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/14/深度优先与广度优先/">深度优先与广度优先</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/14/String.format()字符串格式化/">String.format()字符串格式化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/07/浅谈二叉搜索树/">浅谈二叉搜索树</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/07/jar文件到底是什么/">jar文件到底是什么</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/30/数据库三范式解析/">数据库三范式解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/24/深入理解-Java-虚拟机（二）Java内存区域与内存溢出异常(转)/">深入理解 Java 虚拟机（二）Java内存区域与内存溢出异常(转)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/05/深入理解-Java-虚拟机（一）走近-Java(转)/">深入理解 Java 虚拟机（一）走近 Java(转)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/理解Java虚拟机体系结构(转)/">理解Java虚拟机体系结构(转）</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 Chuanhe Liu
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>